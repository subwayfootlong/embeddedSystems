<!-- <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pico W Live Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <h2>Pico W Live Data</h2>
    
    <h3>Temperature</h3>
    <canvas id="chartTemp"></canvas>

    <h3>Humidity</h3>
    <canvas id="chartHum"></canvas>

    <h3>Light</h3>
    <canvas id="chartLight"></canvas>

    <script>
      const makeChart = (id, label) => new Chart(document.getElementById(id), {
        type: 'line',
        data: { labels: [], datasets: [{ label, data: [], borderWidth: 2 }] },
        options: { scales: { y: { beginAtZero: false } } }
      });

      const chartTemp = makeChart('chartTemp', 'Temperature (Â°C)');
      const chartHum  = makeChart('chartHum',  'Humidity (%)');
      const chartLight= makeChart('chartLight','Light Level');

      async function fetchData() {
        const res = await fetch('/data');
        const d = await res.json();

        const charts = [
          { chart: chartTemp, value: d.temp },
          { chart: chartHum,  value: d.humidity },
          { chart: chartLight,value: d.light }
        ];

        charts.forEach(({chart,value}) => {
          chart.data.labels.push(d.time);
          chart.data.datasets[0].data.push(value);
          if (chart.data.labels.length > 30) {
            chart.data.labels.shift();
            chart.data.datasets[0].data.shift();
          }
          chart.update();
        });
      }
      setInterval(fetchData, 1000);
    </script>
  </body>
</html> -->